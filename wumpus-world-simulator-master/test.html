<!DOCTYPE html>
<html>
<head>
    <title>Wumpus Test</title>
    <style>
        body { margin: 0; padding: 20px; background: #333; }
        canvas { border: 2px solid white; background: black; }
    </style>
</head>
<body>
    <h1 style="color: white;">ğŸ¯ Wumpus World Test</h1>
    <canvas id="canvas" width="480" height="480"></canvas>
    
    <script src="js/utils/array-utils.js"></script>
    <script src="js/utils/random-utils.js"></script>
    <script src="js/core/resources.js"></script>
    
    <script>
        // ØªÙ‡ÙŠØ¦Ø© resources Ø¨Ø³ÙŠØ·Ø©
        if (!window.resources) {
            window.resources = {
                images: {},
                play: function() {},
                stop: function() {}
            };
        }
        
        // ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø£Ø±Ø¶ÙŠØ© Ø¨Ø³ÙŠØ·Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
        var floorImg = new Image();
        floorImg.onload = function() {
            resources.images.floor = floorImg;
            startGame();
        };
        floorImg.src = 'img/floor.png';
        
        // ØµÙˆØ±Ø© Ø¨Ø¯ÙŠÙ„Ø© Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        floorImg.onerror = function() {
            console.log("âš ï¸ Could not load floor.png, using fallback");
            createFallbackImage();
            startGame();
        };
        
        function createFallbackImage() {
            // Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØ±Ø© Ø£Ø±Ø¶ÙŠØ© Ø¨Ø¯ÙŠÙ„Ø©
            var canvas = document.createElement('canvas');
            canvas.width = 48;
            canvas.height = 48;
            var ctx = canvas.getContext('2d');
            
            // Ø±Ø³Ù… Ù…Ø±Ø¨Ø¹ Ø¨Ù†ÙŠ
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(0, 0, 48, 48);
            
            // Ø¥Ø¶Ø§ÙØ© Ø®Ø·ÙˆØ·
            ctx.strokeStyle = '#654321';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(0, 0);
            ctx.lineTo(48, 48);
            ctx.moveTo(48, 0);
            ctx.lineTo(0, 48);
            ctx.stroke();
            
            var img = new Image();
            img.src = canvas.toDataURL();
            resources.images.floor = img;
        }
        
        function startGame() {
            console.log("âœ… Resources ready, loading game scripts...");
            
            // ØªØ­Ù…ÙŠÙ„ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øª
            var scripts = [
                'js/core/environment.js',
                'js/core/keys.js', 
                'js/core/player.js',
                'js/script.js'
            ];
            
            loadScripts(scripts, function() {
                console.log("ğŸ® All scripts loaded!");
                // Ø§Ù„Ù„Ø¹Ø¨Ø© Ø³ØªØ¨Ø¯Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø®Ù„Ø§Ù„ $(document).ready ÙÙŠ script.js
            });
        }
        
        function loadScripts(urls, callback) {
            var loaded = 0;
            
            urls.forEach(function(src) {
                var script = document.createElement('script');
                script.src = src;
                script.onload = function() {
                    loaded++;
                    console.log("âœ… Loaded:", src);
                    if (loaded === urls.length) {
                        callback();
                    }
                };
                script.onerror = function() {
                    console.error("âŒ Failed to load:", src);
                    loaded++;
                    if (loaded === urls.length) {
                        callback();
                    }
                };
                document.head.appendChild(script);
            });
        }
    </script>
</body>
</html>